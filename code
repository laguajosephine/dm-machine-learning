#Question 1
#On sépare le jeu de données

from sklearn.model_selection import train_test_split
X_train, X_test, y_train, y_test = train_test_split(X,y)


#Question 2
#On entraine les SVM

from sklearn.svm import LinearSVC
svm = LinearSVC(C=5).fit(X_train,y_train)
print('Score: ',svm.score(X_test,y_test))

#On fait une validation croisée sur l'échantillon d'apprentissage

from sklearn.model_selection import cross_val_score
scores = cross_val_score(svm,X_train,y_train,cv=5)

#On défini un array y_test_predict

y_test_predict=svm.predict(X_test)


#Question 3
#On construit la matrice de confusion

from sklearn.metrics import confusion_matrix
confusion_matrix_test = confusion_matrix(y_test,y_test_predict)
print(confusion_matrix_test)

#On calcule la précision et le rappel avec la matrice de confusion
rappel = confusion_matrix_test[0][0]/(confusion_matrix_test[0][0]+confusion_matrix_test[0][1])
precision = confusion_matrix_test[0][0]/(confusion_matrix_test[0][0]+confusion_matrix_test[1][0])
print('Rappel: ',rappel, 'Precision: ',precision)

#On vérifie que nos calculs étaient bons
from sklearn.metrics import recall_score, precision_score
print('Rappel: ',recall_score(y_test,y_test_predict,pos_label=0))
print('Precision: ',precision_score(y_test,y_test_predict,pos_label=0))
